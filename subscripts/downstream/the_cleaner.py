                                                                                                                    
the_cleaner='''                                                                                                                    
                                             @@@@@@@@@@@@@@@@@@@@@@@@@@                                             
                                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                        
                                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                    
                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@                                 
                              @@@@@@@@@@@@@@@@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@                              
                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@@@                            
                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@  @@@@@@@@@@@@@@@@@@@@@@@@@@                          
                       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   @      @@@@@@@@@@@@@@@@@@@@@@@@@@@                        
                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@                      
                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   @@    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     
                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  
                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 
                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                
               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             @         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               
              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  @          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              
             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   @           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   @            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                       @        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @               @         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @               @         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       @                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@          
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @               @         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@          
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@          
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     @                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   @                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @              @         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               @      @  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            
             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             
             @@@@@@@@@@@@@@@@@@@@@@@@@@      @@@   @@      @@       @   @@   @@@@@@@@@@@@@@@@@@@@@@@@@@             
              @@@@@@@@@@@@@@@@@@@@@@@@@       @@   @@       @       @   @@   @@@@@@@@@@@@@@@@@@@@@@@@@              
               @@@@@@@@@@@@@@@@@@@@@@@@   @   @@   @@   @   @@@   @@@   @@  @@@@@@@@@@@@@@@@@@@@@@@@@               
                @@@@@@@@@@@@@@@@@@@@@@@   @   @@   @@   @   @@@   @@@@      @@@@@@@@@@@@@@@@@@@@@@@@                
                  @@@@@@@@@@@@@@@@@@@@@   @   @@   @@       @@@   @@@@@    @@@@@@@@@@@@@@@@@@@@@@@                  
                    @@@@@@@@@@@@@@@@@@@   @   @@   @@      @@@@   @@@@@   @@@@@@@@@@@@@@@@@@@@@                     
                      @@@@@@@@@@@@@@@@@   @   @@   @@      @@@@   @@@@@   @@@@@@@@@@@@@@@@@@@@                      
                        @@@@@@@@@@@@@@@   @   @@   @@   @   @@@   @@@@@   @@@@@@@@@@@@@@@@@@                        
                          @@@@@@@@@@@@@   @   @@   @@   @   @@@   @@@@@   @@@@@@@@@@@@@@@@                          
                            @@@@@@@@@@@       @@   @@   @   @@@   @@@@@   @@@@@@@@@@@@@@                            
                              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                              
                                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                 
                                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                    
                                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                        
                                              @@@@@@@@@@@@@@@@@@@@@@@@                                              

                           ___     ___       ___  __           __   ___          ___     __   __          __  
            |  | |__|  /\   |     |__  \  / |__  |__)     /\  |__) |__     |  | |__     / _` /  \ | |\ | / _` 
            |/\| |  | /~~\  |     |___  \/  |___ |  \    /~~\ |  \ |___    |/\| |___    \__> \__/ | | \| \__> 
                                                                                                            
                           ___  __      __   __            ___              __       __                                   
                            |  /  \    |  \ /  \    |  | |  |  |__|    \ / /  \ |  |  _|                                  
                            |  \__/    |__/ \__/    |/\| |  |  |  |     |  \__/ \__/  . 
'''
dusty_cups='''


                           __        ___                   __        __      __        __  ___         __        __   __  
 |    |  | | |    |       /  ` |    |__   /\  |\ |    \ / /  \ |  | |__)    |  \ |  | /__`  |  \ /    /  ` |  | |__) /__` 
 |    |/\| | |___ |___    \__, |___ |___ /~~\ | \|     |  \__/ \__/ |  \    |__/ \__/ .__/  |   |     \__, \__/ |    .__/ 
                                                                                                                         
              ___  __   __           ___       ___            __     __   ___     __       ___   /                     
             |__  |__) /  \  |\/|     |  |__| |__     | |\ | /__` | |  \ |__     /  \ |  |  |   /                      
             |    |  \ \__/  |  |     |  |  | |___    | | \| .__/ | |__/ |___    \__/ \__/  |  .                       
                                                                                                                                                                                                                                                                                                                                         
'''                                                                                                                                                                                                                      
                                                                                                                                                                                                                               
                                                                                                                    
import os
import csv
import time


# Define the list of whitelisted CSV filenames
whitelisted_csvs = ['seq_batch_map.csv', 'deleted_rows.csv','tag_file.csv','the_cleaner_hitlist.csv']  # Add your whitelisted filenames here

def find_csv_files(directory):
    # List to store CSV file paths
    csv_files = []
    # Search in the current directory
    for item in os.listdir(directory):
        item_path = os.path.join(directory, item)  # Full path of the item
        if item.endswith('.csv') and item not in whitelisted_csvs:
            csv_files.append(item_path)
        # If the item is a directory, search one level deep
        elif os.path.isdir(item_path):
            for subitem in os.listdir(item_path):
                subitem_path = os.path.join(directory, item, subitem)  # Full path of the subitem
                if subitem.endswith('.csv') and subitem not in whitelisted_csvs:
                    csv_files.append(subitem_path)
    return csv_files

def load_filter_data(filter_file):
    # Set to store pairs to be removed
    filter_data = set()
    # Read filter file
    with open(filter_file, mode='r', newline='', encoding='utf-8') as file:
        reader = csv.reader(file)
        for row in reader:
            # Combine first and second column to create a key
            key = row[0].strip() + row[1].strip()
            filter_data.add(key)
    return filter_data


def dry_run_delete_rows(csv_files, filter_data, output_file):
    # Open the output file for writing
    with open(output_file, mode='w', newline='', encoding='utf-8') as out_file:
        writer = csv.writer(out_file)
        # Iterate through each file
        for file in csv_files:
            print('Cleaning cup...')
            with open(file, mode='r', newline='', encoding='utf-8') as csv_file:
                reader = csv.reader(csv_file)
                for row in reader:
                    # Check if the row matches the filter criteria
                    key = row[0].strip() + row[1].strip()
                    if key in filter_data:
                        writer.writerow([f'Deleted from {file}'] + row)

def actual_delete_rows(csv_files, filter_data):
    for file in csv_files:
        updated_rows = []
        with open(file, mode='r', newline='', encoding='utf-8') as csv_file:
            reader = csv.reader(csv_file)
            for row in reader:
                key = row[0].strip() + row[1].strip()
                if key not in filter_data:
                    updated_rows.append(row)
        with open(file, mode='w', newline='', encoding='utf-8') as csv_file:
            writer = csv.writer(csv_file)
            writer.writerows(updated_rows)

# Main script execution
if __name__ == "__main__":
    print(the_cleaner)
    time.sleep(2)
    print(dusty_cups)
    time.sleep(2)

    directory = '.'  # Current directory
    filter_file = 'the_cleaner_hitlist.csv'  # Name of the CSV file with filter data
    output_file = 'deleted_rows.csv'  # Output file for dry run
    csv_files = find_csv_files(directory)
    print(f'Found {len(csv_files)} dusty cups...')
    filter_data = load_filter_data(filter_file)    

    # Dry run: print and log what would be deleted
    dry_run_delete_rows(csv_files, filter_data, output_file)

    # UNCOMMENT to actually delete rows, after verifying the dry run. THIS IS IRREVERSIBLE!!
    # actual_delete_rows(csv_files, filter_data)
    
    print(f'{len(csv_files)} dusty cups cleaned.')
